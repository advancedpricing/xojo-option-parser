<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>OptionParser - OptionParser (API)</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">OptionParser (API)</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">OptionParser <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class="active">
                                <a href="./">OptionParser</a>
                            </li>
                        
                            <li >
                                <a href="../Option/">Option</a>
                            </li>
                        
                            <li >
                                <a href="../OptionInvalidKeyValueException/">OptionInvalidKeyValueException</a>
                            </li>
                        
                            <li >
                                <a href="../OptionParserException/">OptionParserException</a>
                            </li>
                        
                            <li >
                                <a href="../OptionMissingKeyException/">OptionMissingKeyException</a>
                            </li>
                        
                            <li >
                                <a href="../OptionUnrecognizedKeyException/">OptionUnrecognizedKeyException</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../LICENSE/">License</a>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../..">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../Option/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#optionparseroptionparser">OptionParser.OptionParser</a></li>
        
            <li><a href="#overview">Overview</a></li>
        
            <li><a href="#how-to-supply-command-line-parameters">How to supply command line parameters</a></li>
        
            <li><a href="#properties">Properties</a></li>
        
            <li><a href="#methods">Methods</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="optionparseroptionparser">OptionParser.OptionParser</h1>
<h2 id="overview">Overview</h2>
<p><code>OptionParser</code> is the glue between <code>Option</code> classes and the command line as supplied via
the <code>Run</code> event's <code>args()</code> parameter in a <code>ConsoleApplication</code> or via a call to 
<code>System.CommandLine</code> in a Desktop or Web application. It handles actually parsing the
command line, populating the associated <code>Option</code>s and validating it as a whole.</p>
<h2 id="how-to-supply-command-line-parameters">How to supply command line parameters</h2>
<p><code>OptionParser</code> is versitle on it's use of command line options.</p>
<ul>
<li>Options can appear anywhere on the command line</li>
<li>Extra can be at the start, middle or end of the command line</li>
<li>Short options can be combined</li>
<li>Long options with assignment utilize the equal sign (<code>=</code>)</li>
<li>Short options can optionally use the <code>=</code> sign</li>
<li>File and Directory options can be a full or relative path</li>
</ul>
<p>Here are some example uses at the command line:</p>
<pre class="prettyprint well"><code># Options for a fictitious copy program
#
# -r/--recursive
# -v/--verbose
# -l/--log FILE

# copy the $HOME/Desktop/Folder to /tmp recursively with verbose turned on

$ cp -rv ~/Desktop/Folder /tmp

# same thing

$ cp ~/Desktop/Folder -r /tmp -v

# enable logging to a file

$ cp -rv --log=file.txt ~/Desktop/Folder /tmp

# enable logging to a file using combined short options 

$ cp -rvl=file.txt ~/Desktop/Folder /tmp
</code></pre>

<h2 id="properties">Properties</h2>
<h3 id="additionalhelpnotes-as-string">AdditionalHelpNotes As String</h3>
<p>Displayed after the help message generated by <code>OptionParser</code> when the
help screen is shown.</p>
<p>This can be used to provide further usage notes and to expand on options
when a single line description is not sufficient.</p>
<h3 id="appdescription-as-string">AppDescription As String</h3>
<p>Typically a single line description of the application that is displayed
before the application help.</p>
<h3 id="appname-as-string">AppName As String</h3>
<p>Name of the application. If empty, <code>OptionParser</code> will assign the <code>AppName</code>
variable to the name of the executable filename. This is displayed when 
user help is shown.</p>
<h3 id="extra-as-string">Extra() As String</h3>
<p>Any non-option parameters given to the application will be appended
to this array. For example:</p>
<pre class="prettyprint well"><code>$ my-app --verbose -o ./docs file.txt file2.txt file3.txt
</code></pre>

<p>In the above case, the <code>Extras</code> array will contain three
strings:</p>
<pre class="prettyprint well"><code>0 = &quot;file.txt&quot;
1 = &quot;file2.txt&quot;
2 = &quot;file3.txt&quot;
</code></pre>

<h3 id="extrasrequired-as-integer-0">ExtrasRequired As Integer = 0</h3>
<p>Specify the minimum number of extra items required. For example, say you are
writing a copy program. One might set this value to <code>2</code>.</p>
<pre class="prettyprint well"><code>$ copy extra1 extra2
</code></pre>

<p>See <code>Extra</code> for more information.</p>
<h3 id="helprequested-as-boolean">HelpRequested As Boolean</h3>
<p><code>True</code> when the user supplies either <code>-h</code> or <code>--help</code> on the command line.</p>
<h2 id="methods">Methods</h2>
<h3 id="addoptiono-as-option">AddOption(o As Option)</h3>
<p>Add an option to the parser.</p>
<h3 id="parameters">Parameters</h3>
<ul>
<li><code>o</code> - <code>Option</code> to add</li>
</ul>
<h3 id="exceptions">Exceptions</h3>
<p><code>OptionParserException</code> can be thrown if one attempts to add an option with the same
short or long key as an existing option.
Validation</p>
<h3 id="arguments-as-string">Arguments() As String()</h3>
<p>Get the original arguments passed to the <code>OptionParser</code> as
a <code>String</code> array.</p>
<h3 id="booleanvaluekey-as-variant-defaultvalue-as-boolean-false-as-boolean">BooleanValue(key As Variant, defaultValue As Boolean = False) As Boolean</h3>
<p>Retrieve the contents of an option as a <code>Boolean</code> value.</p>
<h3 id="parameters_1">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
<li><code>defaultValue</code> - Value to return if the user did not supply this option.</li>
</ul>
<h3 id="notes">Notes</h3>
<p>The option type must be that of <code>OptionType.Boolean</code>.</p>
<h3 id="constructorappname-as-string-appdescription-as-string">Constructor(appName As String = "", appDescription As String = "")</h3>
<p>Construct a new <code>OptionParser</code></p>
<h3 id="parameters_2">Parameters</h3>
<ul>
<li><code>appName</code> - Name of the application to display when showing help.</li>
<li><code>appDescription</code> - Description of the application to display when showing help.</li>
</ul>
<p>For more inforation on the parameters, see the two properties <code>AppName</code> and <code>AppDescription</code>.</p>
<h3 id="notes_1">Notes</h3>
<p>When creating a new <code>OptionParser</code> the "Help" option is added automatically. The "Help"
option uses the short key <code>h</code> and the long key <code>help</code>, thus they can not be used by
the application.</p>
<h3 id="datevaluekey-as-variant-defaultvalue-as-date-nil-as-date">DateValue(key As Variant, defaultValue As Date = Nil) As Date</h3>
<p>Retrieve the contents of an option as a <code>Date</code> value.</p>
<h3 id="parameters_3">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
<li><code>defaultValue</code> - Value to return if the user did not supply this option.</li>
</ul>
<h3 id="notes_2">Notes</h3>
<p>The option type must be that of <code>OptionType.Date</code>.</p>
<p><strong>WARNING</strong>:
If the <code>Option.IsValidDateRequired</code> is set to <code>True</code> then the value supplied must
pass the test of <code>ParseDate()</code>. If, however, <code>Option.IsValidDateRequired</code> is
set to <code>False</code> and <code>ParseDate()</code> can not handle the date properly, the value is
recorded as a <code>String</code> not a <code>Date</code>.</p>
<p>This behavior is likely to change in the future. If one requests the type be a
valid date, then the value will have to pass as a valid date or a <code>OptionInvalidKeyValueException</code>
will be raised to indicate that an invalid option value has been supplied.</p>
<h3 id="doublevaluekey-as-variant-defaultvalue-as-double-00-as-double">DoubleValue(key As Variant, defaultValue As Double = 0.0) As Double</h3>
<p>Retrieve the contents of an option as a <code>Double</code> value.</p>
<h3 id="parameters_4">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
<li><code>defaultValue</code> - Value to return if the user did not supply this option.</li>
</ul>
<h3 id="notes_3">Notes</h3>
<p>The option type must be that of <code>OptionType.Double</code>.</p>
<h3 id="filevaluekey-as-variant-defaultvalue-as-folderitem-nil-as-folderitem">FileValue(key As Variant, defaultValue As FolderItem = Nil) As FolderItem</h3>
<p>Retrieve the contents of an option as a <code>FolderItem</code> value.</p>
<h3 id="parameters_5">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
<li><code>defaultValue</code> - Value to return if the user did not supply this option.</li>
</ul>
<h3 id="notes_4">Notes</h3>
<p>The option type must be that of <code>OptionType.File</code> or <code>OptionType.Folder</code>.</p>
<p><strong>WARNING</strong>:
This will likely be renamed to <code>FolderItemValue</code> in the future.</p>
<h3 id="integervaluekey-as-variant-defaultvalue-as-integer-0-as-integer">IntegerValue(key As Variant, defaultValue As Integer = 0) As Integer</h3>
<p>Retrieve the contents of an option as a <code>Integer</code> value.</p>
<h3 id="parameters_6">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
<li><code>defaultValue</code> - Value to return if the user did not supply this option.</li>
</ul>
<h3 id="notes_5">Notes</h3>
<p>The option type must be that of <code>OptionType.Integer</code>.</p>
<h3 id="optionvaluekey-as-string-as-option">OptionValue(key As String) As Option</h3>
<p>Retrieve the actual <code>Option</code> object associated with the <code>key</code>.</p>
<h3 id="parameters_7">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
</ul>
<h3 id="notes_6">Notes</h3>
<p>Once <code>Parse</code> has been called, changing parameters in the <code>Option</code> object will
have no bearing or change.</p>
<p>One can use this to check the <code>WasSet</code> property of the <code>Option</code> class.</p>
<h3 id="parseargs-as-string">Parse(args() As String)</h3>
<p>Parse the arguments</p>
<h3 id="parameters_8">Parameters</h3>
<ul>
<li><code>args()</code> - Command line arguments already split into an array. Generally this will be used
  with a <code>ConsoleApplication</code> since it's <code>Run</code> event passes in command line parameters this way.</li>
</ul>
<h3 id="exceptions_1">Exceptions</h3>
<ul>
<li><code>OptionUnrecognizedKeyException</code> can be raised in the event an invalid argument is supplied.
   For example, the user types <code>myprog --coun=12</code> when it should have been <code>--count=12</code>.</li>
<li><code>OptionInvalidKeyValueException</code> can be raised in the event a valid argument is supplied with
  an invalid value. For example <code>--count=John</code> where <code>count</code> was suppose to be an <code>Integer</code>.</li>
<li><code>OptionParserException</code> can be raised in the event that the application expects at least X
  extra items but the user did not supply at least X extra items.</li>
</ul>
<h3 id="parsevalue-as-string">Parse(value As String)</h3>
<p>Parse the arguments into a <code>String</code> array of parameters, then pass the contents of that
array to the 'real' <code>Parse(args() As String)</code> method.</p>
<h3 id="parameters_9">Parameters</h3>
<ul>
<li><code>value</code> - Command line arguments contained in a single line string. This is most often
  used in a Desktop or Web application via a call to <code>System.CommandLine</code> as a Desktop
  and Web application has no direct access to the <code>args()</code> parameter that a <code>ConsoleApplication</code>
  does.</li>
</ul>
<h3 id="notes_7">Notes</h3>
<p>See <code>Parse(args() As String)</code> for more detailed information</p>
<h3 id="showhelpsectiontitle-as-string-help">ShowHelp(sectionTitle As String = "Help")</h3>
<p>Display a nicely formatted help message including various pieces of meta
data such as <code>AppName</code>, <code>AppDescription</code> and <code>AdditionalHelpNotes</code>. Mixed
in there are of course all of the possible options with their short and long
keys, value types (if any) and description</p>
<h3 id="parameters_10">Parameters</h3>
<ul>
<li><code>sectionTitle</code> - One can overide the section title in case they have multiple
  help screen outputs or have utilized more than one <code>OptionParser</code> for some
  advanced techniques.</li>
</ul>
<h3 id="notes_8">Notes</h3>
<p>Right now there is not a nice GUI for displaying the command line help for
a GUI application or a Web application.</p>
<ul>
<li>For a console application, the output is <code>Print</code> to the screen.</li>
<li>For a GUI application, the output is given to <code>MsgBox</code></li>
<li>For a Web application, help is not currently displayed.</li>
</ul>
<p><strong>WARNING</strong>: It is likely that for console applications the call to <code>Print</code>
will changes to <code>StdErr.Write</code> instead.</p>
<h3 id="stringvaluekey-as-variant-defaultvalue-as-string-as-string">StringValue(key As Variant, defaultValue As String = "") As String</h3>
<p>Retrieve the contents of an option as a <code>String</code> value.</p>
<h3 id="parameters_11">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
<li><code>defaultValue</code> - Value to return if the user did not supply this option.</li>
</ul>
<h3 id="notes_9">Notes</h3>
<p>The option type must be that of <code>OptionType.String</code>.</p>
<h3 id="arrayvaluekey-as-variant-as-variant">ArrayValue(key As Variant) As Variant()</h3>
<p>Retrieve the contents of an option as a <code>Variant</code> array. The contents
of the array are of course a <code>Variant</code> however the actual value assigned to the
<code>Variant</code> is that of the options <code>OptionType</code>. For example, if this option is
of the <code>OptionType.Integer</code> value, then the resulting array will be an array
containing parsed <code>Integer</code> values from the command line. The same is true for
any of the <code>OptionType</code> values.</p>
<h3 id="parameters_12">Parameters</h3>
<ul>
<li><code>key</code> - Key of the option to retrieve. This can be the short or long key. Convention
  is to use the long key if available as it produces more readable code.</li>
</ul>
<h3 id="notes_10">Notes</h3>
<p>The option needs to have the <code>IsArray</code> property set to <code>True</code> to utilize this method.</p>
</div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="https://github.com/jcowgar/xojodoc">XojoDoc</a> and formatted with <a href="http://mkdocs.org">mkdocs</a>.</p>
            
            <!--<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>-->
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>
        <script src="../../js/base.js"></script>
        
    </body>
</html>